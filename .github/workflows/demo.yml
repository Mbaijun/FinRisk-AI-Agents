åç§°ï¼šæ¯æ—¥æ¼”ç¤ºéƒ¨ç½²

åœ¨ï¼š
  æ—¥ç¨‹å®‰æ’:
    # æ¯å¤© UTC æ—¶é—´ 00:00 ï¼ˆåŒ—äº¬æ—¶é—´æ—©ä¸Š8ç‚¹ï¼‰è¿è¡Œä¸€æ¬¡ï¼Œç”Ÿæˆæ–°çš„ngroké“¾æ¥

  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘
    è¾“å…¥ï¼š
      åŸå› :
        æè¿°: 'æ‰‹åŠ¨è§¦å‘åŸå› '
        å¿…éœ€ï¼š å¦
        é»˜è®¤ï¼š 'æµ‹è¯•éƒ¨ç½²'

å·¥ä½œ:
  éƒ¨ç½²:
    è¿è¡Œäºï¼šubuntu-latest
    æ­¥éª¤ï¼š
    - åç§°: ç»“è´¦ä»£ç 
      ä½¿ç”¨ï¼šactions/checkout@v3

    - åç§°: è®¾ç½®Python
      ä½¿ç”¨ï¼šactions/setup-python@v4
      ä¸ï¼š
        python-versionï¼š'3.11'

    - åç§°: å®‰è£…ä¾èµ–é¡¹
      è¿è¡Œï¼špip install gradio

    - åç§°: åœ¨åå°è¿è¡ŒGradioåº”ç”¨ç¨‹åº
      è¿è¡Œï¼š|
        python run_simple.py &
        ç¡çœ  5  # ç­‰å¾…åº”ç”¨å¯åŠ¨

    - åç§°: è®¾ç½® ngrok
      ä½¿ç”¨ï¼šcrazy-max/ghaction-setup-ngrok@v3
      ä¸ï¼š
        authtokenï¼š${{ secrets.NGROK_AUTHTOKEN }}

    - åç§°: æš´éœ²åº”ç”¨ç¨‹åºå¹¶æ›´æ–°README
      è¿è¡Œï¼š|
        # å¯åŠ¨ngrokå¹¶è·å–å…¬å…±URL
        ngrok http 7860 > /dev/null &
        ç¡çœ  5
        PUBLIC_URL=$(curl -s http://localhost:4040/api/tunnels | jq -r '".tunnels[0].public_url')
        echo "å…¬å…±URL: $PUBLIC_URL"
        
        # ç”¨æ–°é“¾æ¥æ›´æ–°README.md
        sed -i "s|https://.*ngrok-free\.dev|$PUBLIC_URL|g" README.md
        
        # é…ç½®Gitå¹¶æ¨é€æ›´æ–°
        git é…ç½®ç”¨æˆ·åç§° 'github-actions[bot]'
        git é…ç½®ç”¨æˆ·ç”µå­é‚®ä»¶ 'github-actions[bot]@users.noreply.github.com'
        git add README.md
        git commit -m "ğŸ¤– è‡ªåŠ¨æ›´æ–°æ¼”ç¤ºé“¾æ¥: $PUBLIC_URL" || echo "æ²¡æœ‰å¯æäº¤çš„æ›´æ”¹"
        git æ¨é€
